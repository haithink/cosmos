---
title: "一个openCV函数耗时过大的问题"
date: 2025-01-07
tags: [knn, openCV]
---

一个比较复杂的代码（记为A）里面knnMatch非常耗时，但单独建一个工程，处理的数据量更大，但耗时反而更低。于是，先在A里面迁移单独的测试代码，发现耗时也很低。那就是A的编译选项之类的并无问题。然后直接问AI有哪些可能的情况，AI说了几条，其中一条引起了注意，那就是opencv线程数。之前代码A为了考虑移动端的CPU占用情况，刻意限制了opencv线程数。而之前阅读源码的时候，knnMatch会调用parallel_for_，而parallel_for_自然和线程数有关！果然注释对线程数的设置，耗时大幅降低了。




