---
title: "程序运行结束后内存崩溃问题"
date: 2024-12-23
tags: [ASAN,Crash,Memory]
---

一个程序，运行结束以后，报一个内存错误
```bash
corrupted size vs. prev_size in fastbins
```
查了下，一般说是内存越界之类的，尝试加上-g， Debug编译等等，但崩溃调用栈全在某个开源库中，这显然不是真正的原因。然后打开ASAN编译，结果启动阶段就报错了，说某个全局变量在exe依赖的两个so中都存在。解决了这个问题以后，发现前面那个内存问题也没了，看来就是这个原因导致的，可能析构了两次那个全局变量？印象里《程序员的自我修养》里面讨论过这个问题，可以用某个链接选项解决？

